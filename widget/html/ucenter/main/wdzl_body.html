<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>帮分期</title>
    <link href="../../../css/css/iconfont/iconfont.css" rel="stylesheet" />
    <link href="../../../plugins/swiper/swiper.min.css" rel="stylesheet" />
    <link href="../../../css/css/Hui.css" rel="stylesheet" type="text/css" />
    <style type="text/css">
    #progress {
                position: absolute;
                top: 10px;
                right: 10px;
                width: 100px;
                height: 100px;
                display: -webkit-box;
                -webkit-box-pack: center;
                -webkit-box-align: center;
                -webkit-box-orient: vertical;
                display: none;
            }
            #txt {
                width: 100px;
                height: 100px;
                position: absolute;
                top: 0;
                left: 0;
                display: -webkit-box;
                -webkit-box-pack: center;
                -webkit-box-align: center;
                -webkit-box-orient: vertical;
            }
        .swiper-container { width: 100%; padding-top: 10px; padding-bottom: 50px; }
        .swiper-slide { background-position: center; background-size: cover; width: 200px; height: 310px; }
        .swiper-slide .wzms { font-size: 3rem; text-align: center; padding: 10px; color: #52ace5; }
        .auth-container { width: 200px; height: 255px; border: 1px solid #d7d7d7; border-radius: 5px; }
        .auth-container strong { font-size: 1.6rem; font-weight: 500; margin-top: 10px; padding-bottom: 0; }
        .auth-container .H-icon { padding: 0; height: 140px; }
        .auth-container .H-icon i { font-size: 13rem; }
    </style>
</head>
<body>
<div id="progress">
            <canvas id="myCanvas" width="100" height="100"></canvas>
            <div id="txt">
                <div>
                    <font id="per" size="2">0</font>
                    <font size="2">%</font>
                </div>
                <div>
                    <font size="2">已花费时间</font>
                </div>
                <div>
                    <font id="time" size="2">0s</font>
                </div>
            </div>
        </div>
    <div class="current-process H-padding-10 H-text-align-center">
        <label class="H-font-size-16 H-theme-font-color5 H-display-inline-block H-vertical-align-middle">当前资料完整度：</label>
    </div>
    <div class="swiper-container">
        <div class="swiper-wrapper">
            <div class="swiper-slide">
                <div class="wzms">
                    身份信息
                </div>
                <div class="auth-container H-text-align-center">
                    <strong class="H-padding-10 H-display-block H-theme-font-color5">请留下最真实的自己</strong>
                    <div class="H-icon H-center-all H-line-height-normal"><i class="iconfont icon-shenfenrenzheng H-theme-font-color5"></i></div>
                    <div class="H-margin-10 H-padding-horizontal-both-10" tapmode="" onclick="H.openWin('sfrz_head', 'sfrz_head.html');">
                        <button class="H-button H-width-100-percent  H-font-size-15 H-outline-none H-padding-vertical-both-8 H-padding-horizontal-both-20 H-theme-background-color1 H-theme-font-color-white H-theme-border-color1 H-theme-border-color1-click H-theme-background-color1-click H-theme-font-color1-click H-border-radius-3">现在填写</button>
                    </div>
                </div>
            </div>
            <div class="swiper-slide">
                <div class="wzms">
                    联系人信息
                </div>
                <div class="auth-container H-text-align-center">
                    <strong class="H-padding-10 H-display-block H-theme-font-color5">让身边的人支持你</strong>
                    <div class="H-icon H-center-all H-line-height-normal"><i class="iconfont icon-tubiao04 H-theme-font-color5"></i></div>
                    <div class="H-margin-10 H-padding-horizontal-both-10" tapmode="" onclick="H.openWin('lxrxx_head', 'lxrxx_head.html');">
                        <button class="H-button H-width-100-percent  H-font-size-15 H-outline-none H-padding-vertical-both-8 H-padding-horizontal-both-20 H-theme-background-color1 H-theme-font-color-white H-theme-border-color1 H-theme-border-color1-click H-theme-background-color1-click H-theme-font-color1-click H-border-radius-3">现在填写</button>
                    </div>
                </div>
            </div>
            <div class="swiper-slide">
                <div class="wzms">
                    手机认证
                </div>
                <div class="auth-container H-text-align-center">
                    <strong class="H-padding-10 H-display-block H-theme-font-color5">绑定手机能审核概率</strong>
                    <div class="H-icon H-center-all H-line-height-normal"><i class="iconfont icon-iconfontshoujirenzheng H-theme-font-color5" style="font-size:12rem;"></i></div>
                    <div class="H-margin-10 H-padding-horizontal-both-10" tapmode="" onclick="H.openWin('sjrz_head', 'sjrz_head.html');">
                        <button class="H-button H-width-100-percent  H-font-size-15 H-outline-none H-padding-vertical-both-8 H-padding-horizontal-both-20 H-theme-background-color1 H-theme-font-color-white H-theme-border-color1 H-theme-border-color1-click H-theme-background-color1-click H-theme-font-color1-click H-border-radius-3">现在填写</button>
                    </div>
                </div>
            </div>
            <div class="swiper-slide">
                <div class="wzms">
                    支付宝认证
                </div>
                <div class="auth-container H-text-align-center">
                    <strong class="H-padding-10 H-display-block H-theme-font-color5">提供更多借款还款</strong>
                    <div class="H-icon H-center-all H-line-height-normal"><i class="iconfont icon-zhifubao H-theme-font-color5" style="font-size:11rem;"></i></div>
                    <div class="H-margin-10 H-padding-horizontal-both-10" tapmode="" onclick="H.openWin('zfbrz_head', 'zfbrz_head.html');">
                        <button class="H-button H-width-100-percent  H-font-size-15 H-outline-none H-padding-vertical-both-8 H-padding-horizontal-both-20 H-theme-background-color1 H-theme-font-color-white H-theme-border-color1 H-theme-border-color1-click H-theme-background-color1-click H-theme-font-color1-click H-border-radius-3">现在填写</button>
                    </div>
                </div>
            </div>
            <div class="swiper-slide">
                <div class="wzms">
                    持证自拍
                </div>
                <div class="auth-container H-text-align-center">
                    <strong class="H-padding-10 H-display-block H-theme-font-color5">提供更多借款还款</strong>
                    <div class="H-icon H-center-all H-line-height-normal"><i class="iconfont icon-552cc3b3b9fae H-theme-font-color5" style="font-size:11rem;"></i></div>
                    <div class="H-margin-10 H-padding-horizontal-both-10" tapmode="" onclick="H.openWin('czzp_head', 'czzp_head.html');">
                        <button class="H-button H-width-100-percent  H-font-size-15 H-outline-none H-padding-vertical-both-8 H-padding-horizontal-both-20 H-theme-background-color1 H-theme-font-color-white H-theme-border-color1 H-theme-border-color1-click H-theme-background-color1-click H-theme-font-color1-click H-border-radius-3">现在填写</button>
                    </div>
                </div>
            </div>
            <div class="swiper-slide">
                <div class="wzms">
                    学信认证
                </div>
                <div class="auth-container H-text-align-center">
                    <strong class="H-padding-10 H-display-block H-theme-font-color5">请上传学信网截图</strong>
                    <div class="H-icon H-center-all H-line-height-normal"><i class="iconfont icon-boshimao-copy H-theme-font-color5" style="font-size:12rem;"></i></div>
                    <div class="H-margin-10 H-padding-horizontal-both-10" tapmode="active" onclick="comitImgData()">
                        <button class="H-button H-width-100-percent  H-font-size-15 H-outline-none H-padding-vertical-both-8 H-padding-horizontal-both-20 H-theme-background-color1 H-theme-font-color-white H-theme-border-color1 H-theme-border-color1-click H-theme-background-color1-click H-theme-font-color1-click H-border-radius-3">点击上传</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="swiper-pagination"></div>
    </div>
    <script src="../../../plugins/swiper/swiper.min.js"></script>
    <script src="../../../script/h/H.js" type="text/javascript"></script>
        <script type="text/javascript" src="../../../script/mcm/common.js"></script>
    <script type="text/javascript" src="../../../script/mcm/SHA1.js"></script>
    <script type="text/javascript" src="../../../script/mcm/api.js"></script>
        <script type="text/javascript">
            var mcm = null;
            var query = null;
            var clazzNode = null;
            var model = null;
            apiready = function() {
                var key = $api.getStorage('key');
                $api.ajax('/user/'+key, 'get', null, function (ret, err) {
                    if (ret) {
                        $api.setStorage('user', ret.username );
                    } else {
                        $api.toast( err.msg );
                    }
                });

                mcm = api.require('model');
                model = api.require('model');
                query = api.require('query');
                //clazzNode = us;
                //在线编译正式版时，可以不用配置,APICloud会取当前应用的配置
                mcm.config({
                    appId : "A6915918961135",
                    appKey : "02E0067E-57AF-1EBB-12AF-05666A9278D4",
                    url : 'https://d.apicloud.com'
                });
            }
            function capPicture(callback) {
                api.getPicture({
                    sourceType : 'library',
                    encodingType : 'png',
                    mediaValue : 'pic',
                    destinationType : 'url'
                }, function(ret, err) {
                    console.log('获取图片：\n' + JSON.stringify(ret));
                    callback(ret.data, err);
                });
            }

            
         

            function comitImgData() {
                var us = $api.getStorage('user');
                capPicture(function(url) {
                    if (url) {
                        var dt = {
                            file : {
                                name : us, //设置文件名
                                url : url //文件本地地址
                            },
                            values : {//保留字段
                            }
                        }
                        progress.reset();
                        model.uploadFile({
                            data : dt,
                            report : true
                        }, updatePercent);
                    }
                });
            }

            //更新进度
            function updatePercent(ret, err) {
                if (0 == ret.state) {
                    //loading('进度：' + ret.progress);
                    progress.step(ret.progress);
                } else {
                    //finishing();
                    showAlert('上传成功');
                }
            }

            var clazz = "Endo";
            function mcm_insert() {
                var ac = value('xingming');
                var bc = value('shenfen');
                var ax = value('hy');
                var cx = value('xl');
                var dc = {
                    name : ac,
                    number : bc,
                    address : ax,
                    xueli : cx
                };
                var param = {
                    class : clazz,
                    value : dc
                };
                loading();
                mcm.insert(param, function(ret, err) {
                    finishing();
                    if (ret) {
                        showAlert("提交成功");
                        jindua();
                        api.closeWin();
                    } else {
                        showAlert("提交失败，请检查网络设置！");
                    }
                });
            }

        function jindua(){
            var jin = "jindu";
          var us = $api.getStorage('user');
          var bc = '已提交学信网信息';
          var cx = {username:us, jindu:bc}
          var param = {class:jin, value:cx};
          loading();
          mcm.insert(param, function(ret, err){
              finishing();
              if(ret){
                 // showAlert("提交成功,请完善资料");
              }else{
                //  showAlert("提交失败，请检查网络设置！");
              }
          });           
        }
        </script>
        <script>
            function Progress() {
                this.b = 0;
                this.self = null;
                this.per = null
                this.time = null;
                this.context = null;
                this.init = function() {
                    var canvas = document.getElementById('myCanvas');
                    this.context = canvas.getContext('2d');
                    this.context.clearRect(0, 0, 100, 100);
                    this.per = document.getElementById('per');
                    this.time = document.getElementById('time');
                    this.self = document.getElementById('progress');
                }
                this.reset = function() {
                    this.b = new Date().getTime();
                    this.time.innerHTML = '0秒';
                    this.per.innerHTML = '0';
                    this.self.style.display = 'block';
                }
                this.step = function(process) {
                    var now = new Date().getTime();
                    var step = (now - this.b) / 1000;
                    this.time.innerHTML = parseInt(step) + '秒';
                    this.per.innerHTML = parseInt(process);
                    var ctx = this.context;
                    ctx.beginPath();
                    ctx.moveTo(50, 50);
                    ctx.arc(50, 50, 50, 0, Math.PI * 2, false);
                    ctx.closePath();
                    ctx.fillStyle = '#ddd';
                    ctx.fill();
                    ctx.beginPath();
                    ctx.moveTo(50, 50);
                    ctx.arc(50, 50, 50, 0, Math.PI * 2 * process / 100, false);
                    ctx.closePath();
                    ctx.fillStyle = '#e74c3c';
                    ctx.fill();
                    ctx.beginPath();
                    ctx.moveTo(50, 50);
                    ctx.arc(50, 50, 45, 0, Math.PI * 2, true);
                    ctx.closePath();
                    ctx.fillStyle = 'rgba(125,125,125,0.3)';
                    ctx.fill();
                    ctx.beginPath();
                    ctx.arc(50, 50, 40, 0, Math.PI * 2, true);
                    ctx.closePath();
                    ctx.strokeStyle = '#ddd';
                    ctx.stroke();
                    if (100 == process) {
                        setTimeout(function() {
                            progress.self.style.display = 'none';
                        }, 2000);
                    }
                }
            }

            var progress = new Progress();
            progress.init();
        </script>
    <script type="text/javascript">
        var swiper = new Swiper('.swiper-container', {
            initialSlide: 0,
            pagination: '.swiper-pagination',
            effect: 'coverflow',
            grabCursor: true,
            centeredSlides: true,
            slidesPerView: 'auto',
            coverflow: {
                rotate: 50,
                stretch: 0,
                depth: 100,
                modifier: 1,
                slideShadows: false
            }
        });
    </script>
</body>
</html>